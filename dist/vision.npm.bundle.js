!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var r=e();for(var s in r)("object"==typeof exports?exports:t)[s]=r[s]}}(self,(()=>{return t={135:function(t,e,r){"use strict";var s=this&&this.__awaiter||function(t,e,r,s){return new(r||(r=Promise))((function(n,o){function i(t){try{u(s.next(t))}catch(t){o(t)}}function a(t){try{u(s.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(i,a)}u((s=s.apply(t,e||[])).next())}))},n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Vision=void 0;const o=r(994),i=n(r(420));e.Vision=class{constructor(){this.stats={requestCount:0,errorCount:0,totalLatency:0,dbQueryCount:0,dbErrorCount:0,dbTotalLatency:0,lastErrors:[]}}visionRequest(t){this.stats.requestCount++,this.stats.totalLatency+=t}visionError(t,e,r){this.stats.errorCount++;const s={timestamp:new Date,method:e||"",path:r||"",error:t.message};this.stats.lastErrors.length>=10&&this.stats.lastErrors.shift(),this.stats.lastErrors.push(s)}visionDBQuery(t){this.stats.dbQueryCount++,this.stats.dbTotalLatency+=t}visionDBError(){this.stats.dbErrorCount++}getCPUUsage(){return s(this,void 0,void 0,(function*(){return new Promise(((t,e)=>{(0,o.exec)("top -bn1 | grep 'Cpu(s)' | sed 's/.*, *\\([0-9.]*\\)%* id.*/\\1/' | awk '{print 100 - $1}'",((r,s)=>{if(r)return e(`Failed to get CPU usage: ${r}`);t(parseFloat(s))}))}))}))}getMemoryUsage(){return s(this,void 0,void 0,(function*(){return new Promise(((t,e)=>{const r=i.default.totalmem();t((r-i.default.freemem())/r*100)}))}))}getNetworkStats(){return s(this,void 0,void 0,(function*(){return new Promise(((t,e)=>{(0,o.exec)("ifstat -S 1 1 | awk 'NR==3 {print $1}'",((r,s)=>{if(r)return e(`Failed to get network stats: ${r}`);t(parseFloat(s)/1048576)}))}))}))}getVisionStats(){return s(this,void 0,void 0,(function*(){const t=yield this.getCPUUsage().catch((t=>(console.error(`Error getting CPU usage: ${t}`),0))),e=yield this.getMemoryUsage().catch((t=>(console.error(`Error getting memory usage: ${t}`),0))),r=yield this.getNetworkStats().catch((t=>(console.error(`Error getting network stats: ${t}`),0)));return{requests:{total:this.stats.requestCount,errors:this.stats.errorCount,successRate:0===this.stats.requestCount?0:(this.stats.requestCount-this.stats.errorCount)/this.stats.requestCount*100,avgLatencyMs:0===this.stats.requestCount?0:this.stats.totalLatency/this.stats.requestCount},database:{totalQueries:this.stats.dbQueryCount,errors:this.stats.dbErrorCount,avgLatencyMs:0===this.stats.dbQueryCount?0:this.stats.dbTotalLatency/this.stats.dbQueryCount},system:{cpuUsage:t,memoryUsage:e,networkRecv:r},lastErrors:this.stats.lastErrors}}))}}},420:(t,e)=>{e.endianness=function(){return"LE"},e.hostname=function(){return"undefined"!=typeof location?location.hostname:""},e.loadavg=function(){return[]},e.uptime=function(){return 0},e.freemem=function(){return Number.MAX_VALUE},e.totalmem=function(){return Number.MAX_VALUE},e.cpus=function(){return[]},e.type=function(){return"Browser"},e.release=function(){return"undefined"!=typeof navigator?navigator.appVersion:""},e.networkInterfaces=e.getNetworkInterfaces=function(){return{}},e.arch=function(){return"javascript"},e.platform=function(){return"browser"},e.tmpdir=e.tmpDir=function(){return"/tmp"},e.EOL="\n",e.homedir=function(){return"/"}},994:()=>{}},e={},function r(s){var n=e[s];if(void 0!==n)return n.exports;var o=e[s]={exports:{}};return t[s].call(o.exports,o,o.exports,r),o.exports}(135);var t,e}));